<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Solicitud de Servicios</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script>
        function agregarFilaMuestra() {
            const tbody = document.getElementById("muestras-body");
            tbody.insertAdjacentHTML("beforeend", `
                <tr>
                    <td><input type="text" name="muestra_vias" class="form-control"></td>
                    <td><input type="text" name="matriz" class="form-control"></td>
                    <td><input type="text" name="producto_declarado" class="form-control"></td>
                    <td><input type="text" name="referencias" class="form-control"></td>
                </tr>
            `);
        }

        function agregarFilaAnalisis() {
            const tbody = document.getElementById("analisis-body");
            tbody.insertAdjacentHTML("beforeend", `
                <tr>
                    <td><input type="text" name="analisis" class="form-control" oninput="sincronizarMetodos()"></td>
                    <td><input type="text" name="acreditacion" class="form-control"></td>
                    <td><input type="text" name="cantidad_minima" class="form-control"></td>
                    <td><input type="text" name="unidad" class="form-control"></td>
                    <td><input type="text" name="tiempo_reporte" class="form-control"></td>
                </tr>
            `);
        }

        function sincronizarMetodos() {
            const analisisInputs = document.querySelectorAll('input[name="analisis"]');
            const tbody = document.getElementById("metodos-body");
            tbody.innerHTML = "";
            analisisInputs.forEach(input => {
                if (input.value.trim() !== "") {
                    tbody.insertAdjacentHTML("beforeend", `
                        <tr>
                            <td><input type="text" class="form-control" value="${input.value}" readonly></td>
                            <td><input type="text" name="metodo" class="form-control"></td>
                        </tr>
                    `);
                }
            });
        }
    </script>
</head>
<body class="bg-light">
<div class="container mt-4">
    <h2>Solicitud de Servicios</h2>
    <form action="/solicitud" method="post">

        <div class="mb-3">
            <label><strong>Número de Solicitud:</strong></label>
            <input type="text" name="numero_solicitud" value="{{ numero }}" class="form-control" readonly>
        </div>

        <!-- 1ª fila -->
        <div class="row">
            <div class="col-md-4">
                <label>Tipo de Servicio</label>
                <select name="tipo_servicio" class="form-control">
                    <option value="">Seleccione...</option>
                    <option>Servicio A</option>
                    <option>Servicio B</option>
                </select>
            </div>
            <div class="col-md-4">
                <label>Empresa</label>
                <input type="text" name="empresa" class="form-control">
            </div>
            <div class="col-md-4">
                <label>RUC</label>
                <input type="text" name="ruc" class="form-control">
            </div>
        </div>

        <!-- 2ª fila -->
        <div class="row mt-3">
            <div class="col-md-4">
                <label>Titular de Informe</label>
                <input type="text" name="titular_informe" class="form-control">
            </div>
            <div class="col-md-4">
                <label>Producto</label>
                <input type="text" name="producto" class="form-control">
            </div>
            <div class="col-md-4">
                <label>Tipo de Certificado</label>
                <input type="text" name="tipo_certificado" class="form-control">
            </div>
        </div>

        <!-- 3ª fila -->
        <div class="row mt-3">
            <div class="col-md-4">
                <label>Tipo de Proceso</label>
                <input type="text" name="tipo_proceso" class="form-control">
            </div>
            <div class="col-md-4">
                <label>Solicitante</label>
                <input type="text" name="solicitante" class="form-control">
            </div>
            <div class="col-md-4">
                <label>Idioma de Informe</label>
                <input type="text" name="idioma_informe" class="form-control">
            </div>
        </div>

        <!-- 4ª fila -->
        <div class="row mt-3">
            <div class="col-md-4">
                <label>Destino</label>
                <input type="text" name="destino" class="form-control">
            </div>
            <div class="col-md-4">
                <label>Trámite</label>
                <input type="text" name="tramite" class="form-control">
            </div>
            <div class="col-md-4">
                <label>Planta Productora</label>
                <input type="text" name="planta_productora" class="form-control">
            </div>
        </div>

        <!-- 5ª fila -->
        <div class="row mt-3">
            <div class="col-md-4">
                <label>Sede Planta</label>
                <input type="text" name="sede_planta" class="form-control">
            </div>
            <div class="col-md-4">
                <label>Dirección de Inspección</label>
                <input type="text" name="direccion_inspeccion" class="form-control">
            </div>
            <div class="col-md-4">
                <label>Fecha de Inspección/Muestreo</label>
                <input type="date" name="fecha_inspeccion" class="form-control">
            </div>
        </div>

        <!-- 6ª fila -->
        <div class="row mt-3">
            <div class="col-md-4">
                <label>Hora de Inspección/Muestreo</label>
                <input type="time" name="hora_inspeccion" class="form-control">
            </div>
            <div class="col-md-4">
                <label>Observaciones</label>
                <textarea name="observaciones" class="form-control"></textarea>
            </div>
            <div class="col-md-4">
                <label>Observaciones Emisión</label>
                <textarea name="observaciones_emision" class="form-control"></textarea>
            </div>
        </div>

        <!-- 7ª fila -->
        <div class="row mt-3">
            <div class="col-md-4">
                <label>Nota</label>
                <textarea name="nota" class="form-control"></textarea>
            </div>
            <div class="col-md-4">
                <label>Grupo Destinatario/Matriz</label>
                <input type="text" name="grupo_destinatario" class="form-control">
            </div>
        </div>

        <hr>
        <h4>Muestras</h4>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Muestra/Vías</th>
                    <th>Matriz</th>
                    <th>Producto Declarado</th>
                    <th>Referencias</th>
                </tr>
            </thead>
            <tbody id="muestras-body"></tbody>
        </table>
        <button type="button" class="btn btn-secondary" onclick="agregarFilaMuestra()">Agregar Muestra</button>

        <hr>
        <h4>Análisis</h4>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Análisis</th>
                    <th>Acreditación</th>
                    <th>Cantidad Mínima</th>
                    <th>Unidad</th>
                    <th>Tiempo de Reporte</th>
                </tr>
            </thead>
            <tbody id="analisis-body"></tbody>
        </table>
        <button type="button" class="btn btn-secondary" onclick="agregarFilaAnalisis()">Agregar Análisis</button>

        <hr>
        <h4>Métodos</h4>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Análisis</th>
                    <th>Método</th>
                </tr>
            </thead>
            <tbody id="metodos-body"></tbody>
        </table>

        <hr>
        <button type="submit" class="btn btn-primary">Guardar Solicitud</button>
    </form>
</div>
</body>
</html>
